"use strict";(self.webpackChunkcarbonio_login_ui=self.webpackChunkcarbonio_login_ui||[]).push([[902],{902:(e,t,a)=>{a.r(t),a.d(t,{default:()=>G});var n=a(4942),r=a(9439),o=(a(6992),a(1539),a(8783),a(3948),a(1637),a(4916),a(4765),a(3710),a(7941),a(2526),a(7327),a(5003),a(9554),a(4747),a(9337),a(3321),a(9070),a(7294)),i=a(8651),l=a(2115),s=a(6486),c=a(4478);const u=a.p+"assets/c201cd88dd8ac881fb5116d6e523f6c0.svg",d=a.p+"assets/4692c32b7a3da0c90b16af9b4c511dc5.svg",m=a.p+"assets/bf91cbb0a8890f791877c30804d22033.svg",g=a.p+"assets/af8f8b8de3c2c64dd9e0e26f9e326c76.svg",p=a.p+"assets/37914751a841e5bada7088f083ebe8f1.svg",f=a.p+"assets/38bfc573882a13cd65849d7c094d4ad3.svg",h=a.p+"assets/21fac676d4a152cb019e995ec686929c.svg",b=a.p+"assets/8b90fe7b942c6f389f1ddd01103d3b0e.jpg",v=a.p+"assets/a2ca34c391de073172d480fe7977954a.jpg",w=a.p+"assets/c469e23959fd19cc40fbb5e56c083c86.png";var E=a(8313),y=a(5861),x=a(4687),k=a.n(x);function C(e){var t=e.open,a=e.onClose,n=(0,c.$)(),i=(0,r.Z)(n,1)[0];return o.createElement(l.u_,{title:"Offline",open:t,onClose:a},o.createElement(l.nv,null,i("offline","You are currently offline, please check your internet connection")))}var _=i.default.svg.withConfig({displayName:"spinner__StyledSpinner",componentId:"sc-7h2tc3-0"})(["animation:rotate 2s linear infinite;margin:-25px 0 0 -25px;width:50px;height:50px;& .path{stroke:#0000FF;animation:dash 1.5s ease-in-out infinite;}@keyframes rotate{100%{transform:rotate(360deg);}}@keyframes dash{0%{stroke-dasharray:1,150;stroke-dashoffset:0;}50%{stroke-dasharray:90,150;stroke-dashoffset:-35;}100%{stroke-dasharray:90,150;stroke-dashoffset:-124;}}"]);function S(){return o.createElement(_,{viewBox:"0 0 50 50"},o.createElement("circle",{className:"path",cx:"25",cy:"25",r:"20",fill:"none",strokeWidth:"4"}))}a(6699),a(2023),a(2222),a(5306),a(3210);var P=a(4573),Z=new URLSearchParams(window.location.search),O=[{label:"Classic",value:"classic"},{label:"Iris",value:"iris"}];function U(e){var t=e.authError,a=e.submitCredentials,n=e.configuration,i=e.disableInputs,s=e.loading,u=void 0!==s&&s,d=(0,c.$)(),m=(0,r.Z)(d,1)[0],g=(0,o.useState)(Z.get("username")||""),p=(0,r.Z)(g,2),f=p[0],h=p[1],b=(0,o.useState)(""),v=(0,r.Z)(b,2),w=v[0],y=v[1],x=(0,o.useState)(!1),k=(0,r.Z)(x,2),C=k[0],_=k[1],S=(0,o.useMemo)((function(){return(0,P.Mf)().includes("UI")?"iris"===(0,P.ej)("UI")?O[1]:O[0]:((0,P.d8)("UI","iris"),O[1])}),[]),U=(0,o.useCallback)((function(e){if(e.preventDefault(),f&&w){var t=f;Z.has("virtualacctdomain")?t="".concat(t.replace("@","."),"@").concat(Z.get("virtualacctdomain")):Z.has("customerDomain")&&!f.includes("@")&&(t="".concat(t.trim(),"@").concat(Z.get("customerDomain"))),a(t,w)}}),[f,w,a]),I=(0,o.useCallback)((function(){window.location.assign("/zx/auth/startSamlWorkflow?redirectUrl=".concat(n.destinationUrl))}),[n]),j=(0,o.useMemo)((function(){return n.authMethods.includes("saml")?o.createElement(l.zx,{type:"outlined",label:m("login_saml","Login SAML"),color:"primary",disabled:i,onClick:I}):o.createElement("div",{style:{minHeight:"20px"}})}),[n,i,I]);return(0,o.useEffect)((function(){(0,E.j)().then((function(e){_(e.hasClassic),e.hasClassic||(0,P.d8)("UI","iris")}))}),[]),o.createElement("form",{onSubmit:U,style:{width:"100%"}},o.createElement("input",{type:"submit",style:{display:"none"}}),o.createElement(l.X2,{padding:{bottom:"large"}},o.createElement(l.II,{defaultValue:f,disabled:i,onChange:function(e){return h(e.target.value)},hasError:!!t,autocomplete:"username",label:m("username","Username"),backgroundColor:"gray5"})),o.createElement(l.X2,{padding:{bottom:"small"}},o.createElement(l.WU,{defaultValue:w,disabled:i,onChange:function(e){return y(e.target.value)},hasError:!!t,autocomplete:"password",label:m("password","Password"),backgroundColor:"gray5"})),C&&o.createElement(l.X2,{padding:{vertical:"small"}},o.createElement(l.Ph,{label:m("select_ui","Select UI"),items:O,onChange:function(e){(0,P.d8)("UI","iris"===e?"iris":"legacy-zcs")},defaultSelection:S})),o.createElement(l.xv,{color:"error",size:"medium",overflow:"break-word"},t||o.createElement("br",null)),o.createElement(l.X2,{orientation:"vertical",crossAlignment:"flex-start",padding:{bottom:"large",top:"small"}},o.createElement(l.zx,{loading:u,onClick:U,disabled:i,label:m("login","Login"),size:"fill"})),o.createElement(l.X2,{mainAlignment:"flex-end",padding:{bottom:"extralarge"}},j))}function I(e){var t=e.configuration,a=e.disableInputs,n=(0,c.$)(),i=(0,r.Z)(n,1)[0],s=(0,o.useState)(!1),u=(0,r.Z)(s,2),d=u[0],m=u[1],g=(0,o.useState)("credentials"),p=(0,r.Z)(g,2),f=p[0],h=(p[1],(0,o.useState)()),b=(0,r.Z)(h,2),v=b[0],w=b[1],E=(0,o.useState)(!1),x=(0,r.Z)(E,2),_=x[0],Z=x[1],O=(0,o.useState)(!1),I=(0,r.Z)(O,2),j=I[0],A=I[1],L=(0,o.useCallback)((function(e,a){return m(!0),function(e,t,a,n){return fetch("/zx/auth/v1/login",{method:"POST",headers:{"X-Device-Model":(0,P.fj)(),"X-Device-Id":(0,P.yx)(),"X-Service":"webUI","Content-Type":"application/json"},body:JSON.stringify({auth_method:"password",user:t,password:a})})}(0,e,a).then(function(){var n=(0,y.Z)(k().mark((function n(r){return k().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=r.status,n.next=200===n.t0?3:401===n.t0?7:403===n.t0?10:13;break;case 3:return n.next=5,(0,P.Pg)(e,a);case 5:return window.location.assign(t.destinationUrl),n.abrupt("break",15);case 7:return w(i("credentials_not_valid","Credentials are not valid, please check data and try again")),m(!1),n.abrupt("break",15);case 10:return w(i("auth_not_valid","The authentication policy needs more steps: please contact your administrator for more information")),m(!1),n.abrupt("break",15);case 13:Z(!0),m(!1);case 15:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(){return m(!1)}))}),[t.destinationUrl]),T=(0,o.useCallback)((function(){return A(!1)}),[A]),X=(0,o.useCallback)((function(){return A(!0)}),[A]),z=(0,o.useCallback)((function(){return Z(!1)}),[Z]);return o.createElement(o.Fragment,null,"credentials"===f&&o.createElement(U,{configuration:t,disableInputs:a,authError:v,submitCredentials:L,loading:d}),"waiting"===f&&o.createElement(l.X2,{orientation:"vertical",crossAlignment:"center",padding:{vertical:"extralarge"}},o.createElement(S,null)),o.createElement(l.A9,{open:_,label:i("cant_login","Can not do the login now"),actionLabel:i("details","Details"),onActionClick:X,onClose:z,autoHideTimeout:1e4,type:"error"}),o.createElement(C,{open:j,onClose:T}))}a(8674),a(9826),a(6755);var j=a(2211);const A=function(e){var t=e.isLoading,a=e.setIsLoading,n=e.username,i=e.configuration,s=(0,c.$)(),u=(0,r.Z)(s,1)[0],d=(0,o.useState)(""),m=(0,r.Z)(d,2),g=m[0],p=m[1],f=(0,o.useState)(""),h=(0,r.Z)(f,2),b=h[0],v=h[1],w=(0,o.useState)(""),E=(0,r.Z)(w,2),x=E[0],C=E[1],_=(0,o.useState)(!1),S=(0,r.Z)(_,2),Z=S[0],O=S[1],U=(0,o.useState)(!1),I=(0,r.Z)(U,2),A=I[0],L=I[1],T=(0,o.useState)(""),X=(0,r.Z)(T,2),z=X[0],D=X[1],F=(0,o.useCallback)((function(e){return p(e.target.value)}),[p]),V=(0,o.useCallback)((function(e){return v(e.target.value)}),[v]),W=(0,o.useCallback)((function(e){return C(e.target.value)}),[C]);(0,o.useEffect)((function(){L(""),D("")}),[b,u]),(0,o.useEffect)((function(){D(b&&x!==b?u("changePassword_error_confirmPassword","Confirm password not valid"):"")}),[x,b,u]);var M=(0,o.useCallback)((function(e){e.preventDefault(),a(!0),b&&x===b&&!A&&function(e,t,a){return fetch("/service/soap/ChangePasswordRequest",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Body:{ChangePasswordRequest:{_jsns:"urn:zimbraAccount",csrfTokenSecured:"1",persistAuthTokenCookie:"1",account:{by:"name",_content:e},oldPassword:{_content:t},password:{_content:a},prefs:[{pref:{name:"zimbraPrefMailPollingInterval"}}]}}})})}(n,g,b).then(function(){var e=(0,y.Z)(k().mark((function e(t){var r,o,l,s,c,d,m,g,p,f,h;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:m=e.sent,200===t.status&&(g=m.Body.ChangePasswordResponse.authToken,(p=g&&g.length>0?g[0]._content:void 0)&&(0,P.d8)(j.uQ,p)),e.t0=t.status,e.next=200===e.t0?7:401===e.t0||500===e.t0?11:40;break;case 7:return e.next=9,(0,P.Pg)(n,b);case 9:return window.location.assign(i.destinationUrl),e.abrupt("break",43);case 11:if((null===(r=m.Body.Fault)||void 0===r||null===(o=r.Detail)||void 0===o||null===(l=o.Error)||void 0===l?void 0:l.Code)!==j.oT){e.next=38;break}if(O(!1),f=m.Body.Fault.Detail.Error.a,!(h=f?f.find((function(e){return e.n===j.sD})):void 0)){e.next=18;break}return L(u("changePassword_error_maxLength",{defaultValue:"Maximum length is {{num}} characters",replace:{num:h._content}})),e.abrupt("break",43);case 18:if(!(h=f?f.find((function(e){return e.n===j.PB})):void 0)){e.next=22;break}return L(u("changePassword_error_minLength",{defaultValue:"Minimum length is {{num}} characters",replace:{num:h._content}})),e.abrupt("break",43);case 22:if(!(h=f?f.find((function(e){return e.n===j.M$})):void 0)){e.next=26;break}return L(u("changePassword_error_minLowerCaseChars",{defaultValue:"Expecting at least {{num}} lowercase characters",replace:{num:h._content}})),e.abrupt("break",43);case 26:if(!(h=f?f.find((function(e){return e.n===j.Wo})):void 0)){e.next=30;break}return L(u("changePassword_error_minNumericChars",{defaultValue:"Expecting at least {{num}} numeric characters",replace:{num:h._content}})),e.abrupt("break",43);case 30:if(!(h=f?f.find((function(e){return e.n===j.mF})):void 0)){e.next=34;break}return L(u("changePassword_error_minPunctuationChars",{defaultValue:"Expecting at least {{num}} punctuation characters",replace:{num:h._content}})),e.abrupt("break",43);case 34:(h=f?f.find((function(e){return e.n===j.i_})):void 0)&&L(u("changePassword_error_minUppercaseChars",{defaultValue:"Expecting at least {{num}} uppercase characters",replace:{num:h._content}})),e.next=39;break;case 38:(null===(s=m.Body.Fault)||void 0===s||null===(c=s.Detail)||void 0===c||null===(d=c.Error)||void 0===d?void 0:d.Code)===j.SX?(O(!1),L(u("changePassword_error_passwordRecentlyUsed",{defaultValue:"Password recently used"}))):(O(!0),L(""));case 39:return e.abrupt("break",43);case 40:O(!1),L(u("changePassword_error_minLowerCaseChars",{defaultValue:"Expecting at least {{num}} lowercase characters",replace:{num:6}})),a(!1);case 43:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){a(!1),e.message.startsWith("authentication failed")&&(O(!0),L(""))})),a(!1)}),[a,b,x,A,n,g,i.destinationUrl]);return o.createElement("form",{onSubmit:M,style:{width:"100%",height:"auto",maxHeight:"unset"}},o.createElement("input",{type:"submit",style:{display:"none"}}),o.createElement(l.X2,{padding:{bottom:"large"}},o.createElement(l.xv,{size:"large",color:"text",weight:"bold"},u("changePassword_title","Create a new password"))),o.createElement(l.X2,{padding:{top:"large"}},o.createElement(l.II,{defaultValue:n,disabled:!0,label:"Email"})),o.createElement(l.X2,{padding:{top:"large"}},o.createElement(l.WU,{defaultValue:g,hasError:Z,onChange:F,label:u("changePassword_oldPassword","Old password"),backgroundColor:"gray5"})),Z&&o.createElement(l.X2,{padding:{top:"extrasmall"},mainAlignment:"flex-start"},o.createElement(l.xv,{color:"error",size:"medium",overflow:"break-word"},u("wrong_password","Wrong password, please check data and try again"))),o.createElement(l.X2,{padding:{top:"large"}},o.createElement(l.WU,{defaultValue:b,hasError:A,onChange:V,label:u("changePassword_newPassword","New password"),backgroundColor:"gray5"})),A&&o.createElement(l.X2,{padding:{top:"extrasmall"},mainAlignment:"flex-start"},o.createElement(l.xv,{color:"error",size:"medium",overflow:"break-word"},A)),o.createElement(l.X2,{padding:{top:"large"}},o.createElement(l.WU,{defaultValue:x,hasError:z,onChange:W,label:u("changePassword_confirmNewPassword","Confirm new password"),backgroundColor:"gray5"})),z&&o.createElement(l.X2,{padding:{top:"extrasmall"},mainAlignment:"flex-start"},o.createElement(l.xv,{color:"error",size:"medium",overflow:"break-word"},z)),o.createElement(l.X2,{orientation:"vertical",crossAlignment:"flex-start",padding:{vertical:"medium"}},o.createElement(l.zx,{onClick:M,label:u("changePassword_confirm_label","Change password and login"),size:"fill",loading:t,disabled:!b||x!==b||A})))};var L="credentials",T="two-factor",X="change-password";function z(e){var t=e.configuration,a=e.disableInputs,n=(0,c.$)(),i=(0,r.Z)(n,1)[0],u=(0,o.useState)(!1),d=(0,r.Z)(u,2),m=d[0],g=d[1],p=(0,o.useState)(!1),f=(0,r.Z)(p,2),h=f[0],b=f[1],v=(0,o.useState)(L),w=(0,r.Z)(v,2),E=w[0],x=w[1],_=(0,o.useState)(!1),Z=(0,r.Z)(_,2),O=Z[0],I=Z[1],j=(0,o.useState)(!1),z=(0,r.Z)(j,2),D=z[0],F=z[1],V=(0,o.useState)([]),W=(0,r.Z)(V,2),M=W[0],N=W[1],B=(0,o.useState)(""),R=(0,r.Z)(B,2),$=R[0],H=R[1],q=(0,o.useState)(""),J=(0,r.Z)(q,2),Y=J[0],G=J[1],K=(0,o.useCallback)((function(e){G(e.target.value)}),[G]),Q=(0,o.useState)(!1),ee=(0,r.Z)(Q,2),te=ee[0],ae=ee[1],ne=(0,o.useCallback)((function(){return ae((function(e){return!e}))}),[ae]),re=(0,o.useState)(""),oe=(0,r.Z)(re,2),ie=oe[0],le=oe[1],se=(0,o.useState)(!1),ce=(0,r.Z)(se,2),ue=ce[0],de=ce[1],me=(0,o.useState)(!1),ge=(0,r.Z)(me,2),pe=ge[0],fe=ge[1],he=(0,o.useState)(!1),be=(0,r.Z)(he,2),ve=be[0],we=be[1],Ee=(0,o.useCallback)((function(e,a){return g(!0),function(e,t,a,n){return fetch("/zx/auth/v2/login",{method:"POST",headers:{"X-Device-Model":(0,P.fj)(),"X-Device-Id":(0,P.yx)(),"X-Service":"WebUI","Content-Type":"application/json"},body:JSON.stringify({auth_method:"password",user:t,password:a})})}(0,e,a).then((function(n){switch(n.status){case 200:le(e),n.redirected?x(X):n.json().then(function(){var n=(0,y.Z)(k().mark((function n(r){var o,i;return k().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,P.Pg)(e,a);case 2:!0===(null==r?void 0:r["2FA"])?(N((0,s.map)(null!==(o=null==r?void 0:r.otp)&&void 0!==o?o:[],(function(e){return{label:e.label,value:e.id}}))),H(null==r||null===(i=r.otp)||void 0===i?void 0:i[0].id),x(T),g(!1)):window.location.assign(t.destinationUrl);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());break;case 401:I(i("credentials_not_valid","Credentials are not valid, please check data and try again")),g(!1);break;case 403:I(i("auth_not_valid","The authentication policy needs more steps: please contact your administrator for more information")),g(!1);break;default:fe(!0),g(!1)}})).catch((function(){return g(!1)}))}),[t.destinationUrl]),ye=(0,o.useCallback)((function(e){e.preventDefault(),b(!0),function(e,t,a){return fetch("/zx/auth/v2/otp/validate",{method:"POST",headers:{"X-Device-Model":(0,P.fj)(),"X-Device-Id":(0,P.yx)(),"X-Service":"WebUI","Content-Type":"application/json",version:"2"},body:JSON.stringify({id:e,code:t,unsecure_device:!a})})}($,Y,te).then((function(e){200===e.status?e.redirected?x(X):window.location.assign(t.destinationUrl):(b(!1),F(!0))})).catch((function(){return b(!1)}))}),[$,Y,te,t.destinationUrl]),xe=(0,o.useCallback)((function(){return we(!1)}),[we]),ke=(0,o.useCallback)((function(){return we(!0)}),[we]),Ce=(0,o.useCallback)((function(){return fe(!1)}),[fe]);return o.createElement(o.Fragment,null,E===L&&o.createElement(U,{configuration:t,disableInputs:a,authError:O,submitCredentials:Ee,loading:m}),"waiting"===E&&o.createElement(l.X2,{orientation:"vertical",crossAlignment:"center",padding:{vertical:"extralarge"}},o.createElement(S,null)),E===T&&o.createElement("form",{onSubmit:ye,style:{width:"100%"}},o.createElement("input",{type:"submit",style:{display:"none"}}),o.createElement(l.X2,{padding:{bottom:"large"}},o.createElement(l.xv,{size:"large",color:"text",weight:"bold"},i("two_step_authentication","Two-Step-Authentication"))),o.createElement(l.X2,{padding:{top:"large"}},o.createElement(l.Ph,{items:M,background:"gray5",label:i("choose_otp","Choose the OTP Method"),onChange:H,defaultSelection:M[0]})),o.createElement(l.X2,{padding:{top:"large"}},o.createElement(l.II,{defaultValue:Y,hasError:D,disabled:a,onChange:K,label:i("type_otp","Type here One-Time-Password"),backgroundColor:"gray5"})),o.createElement(l.X2,{padding:{top:"extrasmall"},mainAlignment:"flex-start"},o.createElement(l.xv,{color:"error",size:"medium",overflow:"break-word"},D&&i("wrong_password","Wrong password, please check data and try again"),!D&&o.createElement("br",null))),o.createElement(l.X2,{orientation:"vertical",crossAlignment:"flex-start",padding:{vertical:"small"}},o.createElement(l.zx,{onClick:ye,disabled:a,label:i("login","Login"),size:"fill",loading:h})),o.createElement(l.X2,{mainAlignment:"flex-start"},o.createElement(l.XZ,{value:te,label:i("trust_device_and_ip","Trust this device and IP address"),onClick:ne}))),E===X&&o.createElement(A,{isLoading:ue,setIsLoading:de,configuration:t,username:ie}),o.createElement(l.A9,{open:pe,label:i("cant_login","Can not do the login now"),actionLabel:i("details","Details"),onActionClick:ke,onClose:Ce,autoHideTimeout:1e4,type:"error"}),o.createElement(C,{open:ve,onClose:xe}))}function D(){var e=(0,c.$)(),t=(0,r.Z)(e,1)[0],a=(0,o.useState)(!0),n=(0,r.Z)(a,2),i=n[0],s=n[1],u=(0,o.useCallback)((function(){return s(!1)}),[]);return o.createElement(l.A9,{open:i,label:t("server_not_responding","The server is not responding. Please contact your server administrator"),onClose:u,autoHideTimeout:1e4,type:"error"})}var F=a(6227);function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function M(e){var t=e.destinationUrl,a=e.domain,n=(0,o.useState)(null),i=(0,r.Z)(n,2),l=i[0],s=i[1],c=(0,o.useState)(!1),u=(0,r.Z)(c,2),d=u[0],m=u[1],g=(0,o.useState)(!0),p=(0,r.Z)(g,2),f=p[0],h=p[1];return(0,o.useEffect)((function(){var e=!0;return function(e){var t=new URLSearchParams;return e&&t.append("domain",e),fetch("/zx/auth/supported?".concat(t),{method:"GET"}).then((function(e){if(200===e.status)return e.json();throw Error("Notwork Error")}))}(a).then((function(a){e&&(s((function(e){return W(W(W({},e),a),{},{destinationUrl:t})})),h(!1))})).catch((function(){e&&m(!0)})),function(){e=!1}}),[]),(0,o.useEffect)((function(){var e=new URLSearchParams(window.location.search);l&&e.has("loginOp")&&"logout"===e.get("loginOp")&&function(e){return fetch("/zx/auth/v".concat(e.maxApiVersion,"/logout"),{method:"GET"}).then((function(e){if(200!==e.status)throw Error("Notwork Error")}))}(l).catch((function(){return console.log("Logout failed")}))}),[l]),d?o.createElement(D,null):null!==l&&l.destinationUrl?l.maxApiVersion>=2&&l.minApiVersion<=2?o.createElement(z,{configuration:l,disableInputs:f}):l.maxApiVersion>=1&&l.minApiVersion<=1?o.createElement(I,{configuration:l,disableInputs:f}):o.createElement(F.Z,null):o.createElement("div",null)}function N(e){var t=e.destinationUrl,a=(0,c.$)().t,n=(0,o.useState)(),i=(0,r.Z)(n,2),l=i[0],s=i[1],u=(0,o.useState)(!1),d=(0,r.Z)(u,2),m=d[0],g=d[1],p=(0,o.useCallback)((function(e,n){return g(!0),function(e,t){return fetch("/service/soap/AuthRequest",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Body:{AuthRequest:{_jsns:"urn:zimbraAccount",csrfTokenSecured:"1",persistAuthTokenCookie:"1",generateDeviceId:"1",account:{by:"name",_content:e},password:{_content:t},prefs:[{pref:{name:"zimbraPrefMailPollingInterval"}}]}}})})}(e,n).then(function(){var e=(0,y.Z)(k().mark((function e(n){var r;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:if(!(r=e.sent).Body.Fault){e.next=5;break}throw new Error(r.Body.Fault.Reason.Text);case 5:e.t0=n.status,e.next=200===e.t0?8:401===e.t0||500===e.t0?10:403===e.t0?13:16;break;case 8:return window.location.assign(t||window.location.origin),e.abrupt("break",17);case 10:return s(a("credentials_not_valid","Credentials are not valid, please check data and try again")),g(!1),e.abrupt("break",17);case 13:return s(a("auth_not_valid","The authentication policy needs more steps: please contact your administrator for more information")),g(!1),e.abrupt("break",17);case 16:g(!1);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){g(!1),e.message.startsWith("authentication failed")?s(a("credentials_not_valid","Credentials are not valid, please check data and try again")):s(e.message)}))}),[]);return o.createElement(U,{configuration:{destinationUrl:t,authMethods:["zimbra"]},disableInputs:!1,authError:l,submitCredentials:p,loading:m})}function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function $(e){var t=e.changes,a=(0,o.useCallback)((function(e,a){return function(e,t,a){(0,s.forEach)(a,(function(t,a){return(0,s.set)(e,a,t)}))}(e,0,t)}),[]);return(0,l.useSetCustomTheme)(a),null}var H=(0,i.default)(l.W2).withConfig({displayName:"page-layout__LoginContainer",componentId:"sc-3r0rr9-0"})(["padding:0 100px;background:url(",") no-repeat 75% center/cover;justify-content:center;align-items:flex-start;"," ",""],(function(e){return e.backgroundImage}),(function(e){return"mobile"===e.screenMode&&(0,i.css)(["padding:0 12px;align-items:center;"])}),(function(e){return e.isDefaultBg&&(0,i.css)(["@media (-webkit-min-device-pixel-ratio:1.5),(min-resolution:144dpi){background:url(",") no-repeat 75% center/cover;}"],v)})),q=i.default.div.withConfig({displayName:"page-layout__FormContainer",componentId:"sc-3r0rr9-1"})(["max-width:100%;max-height:100vh;box-shadow:0px 0px 20px -7px rgba(0,0,0,0.3);"]),J=(0,i.default)(l.W2).withConfig({displayName:"page-layout__FormWrapper",componentId:"sc-3r0rr9-2"})(["width:auto;height:auto;background-color:",";padding:48px 48px 0;width:436px;max-width:100%;min-height:620px;overflow-y:auto;",""],(function(e){return e.theme.palette.gray6.regular}),(function(e){return"mobile"===e.screenMode&&(0,i.css)(["padding:20px 20px 0;width:360px;max-height:100%;height:auto;"])})),Y=(0,i.default)(l.rU).withConfig({displayName:"page-layout__PhotoLink",componentId:"sc-3r0rr9-3"})([""]);function G(e){var t,a=e.version,n=e.hasBackendApi,i=(0,c.$)(),s=(0,r.Z)(i,1)[0],v=(0,l.K2)(),y=(0,o.useState)(null),x=(0,r.Z)(y,2),k=x[0],C=x[1],_=(0,o.useState)(!1),S=(0,r.Z)(_,2),Z=S[0],O=S[1],U=new URLSearchParams(window.location.search),I=(0,o.useState)((0,P.fF)(U.get("destinationUrl"))),j=(0,r.Z)(I,2),A=j[0],L=j[1],T=(0,o.useState)(null!==(t=U.get("domain"))&&void 0!==t?t:A),X=(0,r.Z)(T,2),z=X[0],F=X[1],V=(0,o.useState)(b),W=(0,r.Z)(V,2),B=W[0],Y=W[1],G=(0,o.useState)(!0),K=(0,r.Z)(G,2),Q=K[0],ee=K[1],te=(0,o.useState)({}),ae=(0,r.Z)(te,2),ne=ae[0],re=ae[1];if((0,o.useLayoutEffect)((function(){var e=!0;return n?(0,E.jv)(a,z,z).then((function(t){A||L((0,P.fF)(t.publicUrl)),z||F(t.zimbraDomainName);var a={};if(e){if(t.loginPageBackgroundImage&&(Y(t.loginPageBackgroundImage),ee(!1)),t.loginPageLogo?(a.image=t.loginPageLogo,a.width="100%"):(a.image=w,a.width="221px"),t.loginPageSkinLogoUrl?a.url=t.loginPageSkinLogoUrl:a.url="",t.loginPageTitle?document.title=t.loginPageTitle:document.title=s("carbonio_authentication","Carbonio Authentication"),t.loginPageFavicon){var n=document.querySelector("link[rel*='icon']")||document.createElement("link");n.type="image/x-icon",n.rel="shortcut icon",n.href=t.loginPageFavicon,document.getElementsByTagName("head")[0].appendChild(n)}if(t.loginPageColorSet){var r=t.loginPageColorSet;r.primary&&re((function(e){return R(R({},e),{},{"palette.primary":(0,P.nu)({regular:"#".concat(r.primary)})})})),r.secondary&&re((function(e){return R(R({},e),{},{"palette.secondary":(0,P.nu)({regular:"#".concat(r.secondary)})})}))}C(a)}})).catch((function(){e&&O(!0)})):(C({image:w,width:"221px"}),document.title=s("carbonio_authentication","Carbonio Authentication")),function(){e=!1}}),[]),Z)return o.createElement(D,null);if(k){var oe=o.createElement("img",{alt:"Logo",src:k.image,width:k.width,style:{maxWidth:"100%",maxHeight:"150px",display:"block",marginLeft:"auto",marginRight:"auto"}});return o.createElement(H,{screenMode:v,isDefaultBg:Q,backgroundImage:B},o.createElement($,{changes:ne}),o.createElement(q,null,o.createElement(J,{mainAlignment:"space-between",screenMode:v},o.createElement(l.W2,{mainAlignment:"flex-start",height:"auto"},o.createElement(l.Zh,{value:"28px 0 28px",crossAlignment:"center",width:"100%"},o.createElement(l.W2,{crossAlignment:"center"},k.url?o.createElement("a",{href:k.url},oe):oe))),n?o.createElement(M,{domain:z,destinationUrl:A}):o.createElement(N,{destinationUrl:A}),o.createElement(l.W2,{crossAlignment:"flex-start",height:"auto",padding:{bottom:"extralarge",top:"extralarge"}},o.createElement(l.xv,null,s("supported_browsers","Supported browsers")),o.createElement(l.X2,{padding:{top:"medium",bottom:"extralarge"},wrap:"nowrap"},o.createElement(l.Zh,{all:"extrasmall",right:"small"},o.createElement(l.u,{label:"Chrome"},o.createElement("img",{alt:"Logo Chrome",src:u,width:"18px"}))),o.createElement(l.Zh,{all:"extrasmall",right:"small"},o.createElement(l.u,{label:"Firefox"},o.createElement("img",{alt:"Logo Firefox",src:d,width:"18px"}))),o.createElement(l.Zh,{all:"extrasmall",right:"small"},o.createElement(l.u,{label:"Edge Chromium"},o.createElement("img",{alt:"Logo Edge Chromium",src:m,width:"18px"}))),o.createElement(l.Zh,{all:"extrasmall",right:"small"},o.createElement(l.u,{label:"Safari"},o.createElement("img",{alt:"Logo Safari",src:g,width:"18px"}))),o.createElement(l.Zh,{all:"extrasmall",right:"small"},o.createElement(l.u,{label:"Opera"},o.createElement("img",{alt:"Logo Opera",src:p,width:"18px"}))),o.createElement(l.Zh,{all:"extrasmall",right:"small"},o.createElement(l.u,{label:"Yandex"},o.createElement("img",{alt:"Logo Yandex",src:f,width:"18px"}))),o.createElement(l.Zh,{all:"extrasmall",right:"small"},o.createElement(l.u,{label:"UC"},o.createElement("img",{alt:"Logo UC",src:h,width:"18px"})))),o.createElement(l.xv,{size:"small",overflow:"break-word"},"Copyright ©"," ".concat((new Date).getFullYear()," Zextras, "),s("all_rights_reserved","All rights reserved"))))))}return null}(0,i.default)(l.xv).withConfig({displayName:"page-layout__PhotoCredits",componentId:"sc-3r0rr9-4"})(["position:absolute;bottom:",";right:",";opacity:50%;&,","{color:#fff;}@media(max-width:767px){display:none;}"],(function(e){return e.theme.sizes.padding.large}),(function(e){return e.theme.sizes.padding.large}),Y)}}]);
//# sourceMappingURL=902.2d70bcfb.chunk.js.map